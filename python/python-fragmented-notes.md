---
title: Python 的一些细碎知识
tags:
  - python
---
## 一、package、module 与 import 
### 1. 模块（Module）
一个模块就是一个 Python 文件。每个模块定义自己的命名空间，可包含变量、函数、类等。使用 `import` 完成导入，导入后以 Module 类的对象存在，所以一般来说无需在自定义类里面设置静态方法，可直接用函数实现，因为在使用中模块内的函数就是本身这个模块的方法。  
一般导入后可用 `import xxxx as xx` 简写模块名称，这实际上是 `xx = xxxx` 的一个语法糖。
### 2. 包（Package）
包是包含 `__init__.py` 文件的目录，同时只有含有 `__init__.py` 文件的目录才能被识别为包。该文件可初始化包环境，控制模块导入行为。一般使用 `from pkg import xxxx` 完成导入。
## 二、Python 的数据模型
### 1. 可变对象和不可变对象
可变对象是指创建后可以改变其内容的对象，不可变对象是指创建后不可以被修改的对象。常见类型以下：
- 可变对象：列表（`list`）、字典（`dist`）、集合（`set`）
- 不可变对象：元组（`tuple`）、字符串（`str`）、整数和浮点数（`int`、`float`）
Python自定义的类对象默认都是可变的，其判断依据是使用 `id()` 函数判断地址是否改变；若想设置为不可变需要特殊设计（使用 `__slots__` 和重写 `__setattr__`或是使用 `@dataclass(frozen=True)`）
### 2. 魔术方法（特殊方法）
魔术方法的一般形式为命名被双下划线包围 `__xxx__` ，该方法是由解释器在特定时机调用，一般是为了能使类直接使用运算符、内置函数等操作。常见魔术方法如下：
- `__new__(cls, ...)`：创建对象实例（先于 `__init__`），一般用于创建单例模式等。
- `__init__(self, ...)`：构造函数，设置属性。
- `__str__(self)`：设置用户友好的字符串输出，常用在 `print(obj)` 执行时调用。
- `__call__(self)`：定义对象被调用时的行为，允许一个类的实例像函数一样被调用。
除了特殊方法外，还存在特殊属性，其形式与魔术方法类似，都是命名被双下划线包围。通常是只读的属性，提供对象的内省信息。
- `__doc__`：访问文件的文档字符串，获取开发者编写的文档注释内容。
- `__class__`：访问实例对象的类型。
## 三、Python 的函数传参
### 1. 参数传递的形式
函数传递参数的形式主要有以下几种，分为位置传递、关键字传递、默认值传递、不定参数传递（包裹传递）、解包裹传递。
- 位置传递：按照函数定义参数顺序传输参数。
- 关键字传递：根据每个参数的名字使用等号传递参数，关键字并不用遵守位置的对应关系。
- 默认值传递：在函数定义参数时给参数赋予默认值，若传递时没有赋值则使用默认值。
- 包裹传递：函数定义参数时不知道或是不关心调用者会传多少参数，在传递时会将收到的参数打包到一个元组里面。形式上需要在函数声明时将参数前加 `*` 符号。如果要打包为字典的话则需要 `**` 符号，并且得指定关键字。
```python
def func(*param):
	print(param)

func(1, 2, 3)
func(1, 2, 3, 4, 5)
```
- 解包裹传递：与包裹传递相反，传递时不想逐一输入或是不想自己将现有元组元素逐一拆包输入，可以直接将有元素数量同函数参数数量的元组直接传递（传递时需要在元组前加 `*` 符号），Python 会将元组元素自行拆包实现参数传递。如果解包裹对象是字典的话则需要 `**` 符号。
```python

def func(a, b, c):
	print((a, b ,c))

arg = (1, 2, 3)  
func(*arg)
```
**注意**：包裹传递和解包裹传递并不是 Python 所特有，其他语言都有类似机制。比如 TypeScript 语言则是使用 `...` 符号，其转换的对象为数组。
### 2. 传递参数的规则
- 若函数定义参数时在参数前后加入 `*` 符号则意味着 `*` 符号后的参数必须使用关键字传递。
- 可变对象参数在函数内修改外部使用时也会感受到修改，而不可变对象不影响外部。
## 四、作用域
Python 是动态类型语言，变量在定义时赋值。作用域就是变量活动的空间，变量作用域取决于其定义位置。由此有以下类型：
- 局部变量：定义在函数内部的变量、在函数声明中的形参。
- 全局变量：直接定义在 `.py` 文件内，且不属于文件内函数、类的变量。
- 自由变量：定义在函数内，嵌套函数之外，且被嵌套函数引用的变量。
- 内置变量：定义在 `builtin` 中的变量。
作用域满足 LEGB 规则。LEGB 规则的 LEGB 分别指代四种变量类型，其规则内容是在本地空间找不到的变量会逐级向上寻找。




