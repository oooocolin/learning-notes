---
title: C++ 关键字与符号
tags:
  - cxx
  - keywords
---
## 引用、指针与 `const` 
### 引用
在 C++ 语言层面上，引用（`T&`）只是某个已有对象的另一个名字。虽然语义上是别名，但编译器底层往往会用一个指针（隐式的）来实现引用。引用一旦建立无法变更绑定关系，后续操作都视为给绑定对象赋值。
```cpp
int a = 10;
int& r = a;
r = 20;
```
### 引用与指针的不同
| 特性              | 指针 (`int* p`) | 引用 (`int& r`)  |
| --------------- | ------------- | -------------- |
| 是否可以为 `nullptr` | 可以            | 不行             |
| 是否可以重新绑定        | 可以（`p = &b;`） | 不行             |
| 是否需要显式解引用       | 需要（`*p`）      | 不需要（`r` 就是原对象） |
| 实现上             | 显式指针          | 编译器自动生成隐藏指针    |
### 引用与 `const` 的结合
`const` 的作用是限制通过当前名字修改对象的能力，即赋值、调用非 `const` 成员函数、取非 `const` 引用等。`const` 与引用结合使得无法通过该引用修改值，但引用对象本身依然可以修改。
```cpp
int a = 10;
const int& r = a;
r = 20;  // 错误：不能通过 r 修改 a

a = 30;   // OK
```
### 指针与 `const` 的结合
 `const` 与指针结合常见于指针常量与常量指针的辨析。常量指针是指针指向可改，指向对象不可改，形式为 `const int* p`；指针常量是指针本身是常量，不能修改指向，指向对象可更改，形式为 `int* const p` 。  
 这会有些反直觉，会被误解为常量指针是“常量的指针”，但这其实是翻译的问题，原文常量指针是 “pointer to const” ，指针常量是 “constant pointer” 从英文来看更符合实际的情况，“pointer to const” 就是指向的常数，表明指向的不可改；“constant pointer” 就是常量的指针，指针本身不可修改指向。最直接的辨别方法就是看 `const` 修饰的右边哪个更近，那个就是不变的那个。
## 语言链接 —— `extern` 关键字
`extern` 不仅作为存储类说明符，提供全局变量/函数的声明，还可以用作语言链接说明符，指示编译器按照指定语言的风格导出指定接口。其目的是使对外显示的接口命名统一且可识别，方便其他语言调用。以下使用 C 语言方式导出。
```cpp
extern "C" { ... }
```
**好处**：
- 避免 C++ 重整符号名（name mangling）。
- 使 DLL 对其他语言兼容性更好。
- 常用于 DLL 接口、回调接口、与 C 程序交互。
```cpp
extern "C" {
#define DLL_EXPORTS __declspec(dllexport)    
	DLL_EXPORTS  int mainFunction(...);    /* 要作为DLL接口的函数 */
}
```
